- 실습

안녕하세요. 이전 영상에서 이론적으로 설명드렸던 Structure from Motion을 실제 처음부터 끝까지 동작시켜보겠습니다.  
제가 설명드렸던 Structure from Motion의 이론적인 내용을 먼저 보고 오셔도 좋습니다.  

먼저 우분투의 패키지를 최신화 시켜주기 위해 sudo apt-get update를 실행시켜줍니다.
비밀번호를 입력해주구요 

sudo apt-get install colmap을 입력해 Structure from Motion을 동작시켜줄 colmap을 설치해줍니다.
저는 이미 설치를 했기때문에 이미 설치했다고 나오네요

그 다음 sudo apt install meshlab을 설치해 줍니다. 
Colmap이 feature간의 point를 3D상으로 표현해준다면 지금 설치하고있는 Meshlab은 색상을 입혀주는 툴입니다.

종료후 잘 설치가 됐는지 확인 합니다. colmap이 잘 설치된것을 보실 수 있습니다. 
실행시켜 이와같은 창이 나오면 잘 설치가 된 것입니다.

그 다음 meshlab도 잘 설치가 됐는지 확인을 해줍니다. 네 잘 설치가 되었구요.

이번 3차원으로 구성해줄 이미지셋을 보겠습니다. 실제 이미지는 이렇게 생겼습니다. 건물을 한바퀴 돌면서 찍었습니다. 
이렇게 동적인 물체 사람도 찍힌것을 보실 수 있구요. 하지만 이것은 다른 사진과 feature들이 매칭되지는 않을겁니다. 
하지만 노이즈 정도로 들어갈수는있겠죠

전체 이미지를 확인해보면 128장에 233.9MB정도의 크기입니다.

다시 콜맵을 실행시켜주고 meshlab도 미리 실행시켜줍니다.

여기 reconstruction을 클릭해줍니다.그리고 automatic reconstruction을 입력합니다.

여기 workspace folder부분은 3D 구성 후 파일을 저장할 폴더를 말합니다.
select folder후 저장할 위치를 찾아줍니다.

저는 홈 디렉토리는 말고 다운로드 해놓았던 이미지 파일이 있는곳 옆에다가 저장시키겠습니다. 원하시는곳에 저장하시면 됩니다. 
새로운 폴더를 만들어 이름은 output으로 해주겠습니다.  open을 클리후

이제 인풋이미지를 넣어줍니다. seleect folder 클릭후 image 데이터들이 담긴 폴더를 선택합니다.

그리고 dense model을 입력해줍니다. quality는 high data type은 individual images로 설정해줍니다. mesher는 푸아송을 선택해줍니다.

그리고 run을 눌러 실행시켜준뒤 기다려줍니다. 이미지 파일크기나 컴퓨터 성능에따라 속도가 다소 차이가 납니다.

설치가 다 됐습니다. ok를 누른뒤 종료하고 한번 보겠습니다. 여기 빨간색은 카메라를 촬영한 위치와 방향을 나타내줍니다. 
이처럼 point들이 잘 관찰되는것을 보실 수 있습니다. 

그리고 이것을 mesh lab에서 다시 보기 위해 파일을 다시 export해줍니다.
여기 export model as를 클릭 후 저장할 이름을 입력합니다. 여기 점 뒤에 꼭 ply를 같이 적어주셔야 합니다.

그리고 파일형식을 ply 클릭 후 종료합니다.

mesh를 들어가줍니다. 
방금 저장한 파일을 드래그해줍니다. 

지금은 다소 이미지가 어떻게 생겼는지 보이지 않는데 좀 조정해보면 보이기 시작합니다. 
아까 보셨던 그림의 윤곽을 보실 수 있고 좀더 채워진것을 보실수있습니다.

주변에 노이즈들도 함께 있는것을 보실수있습니다.

저도 지금 툴은 처음사용하는거라 익숙치는 않습니다.

이것저것 만저보고 있는중입니다.

자세히 보시면 이렇게 포인트들이 있음을 보실 수 있구요

색상도 다소 변경시킬 수 있습니다.

신기합니다.

이렇게 포인트 사이즈도 줄여줄 수 있구요 키워줄수도 있습니다. 

실제 보셨더것과 꽤나 근사한것을 보실 수 있습니다.

이러한 원리가 궁금하시다면 제 영상의 Structure from Motion영상을 보시면 이론을 잘 설명하고 있습니다.
궁금하신점이 있다면 댓글남겨주시면 잘 설명드리겠습니다.

그리고 Structure from Motion이 딥러닝의 데이터셋이 될 수도 있습니다. 이것이 딥러닝으로 어떻게 활용되는지 궁금하시면 제 영상의 poseNet 논문 리뷰를 보시면 됩니다. 

감사합니다.
